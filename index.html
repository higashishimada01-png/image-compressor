<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>画像圧縮ツールくん | 安全・高速・ブラウザ完結</title>
    <!-- デザイン(Tailwind CSS)を読み込む -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- React本体を読み込む -->
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <!-- JSXを動かすための変換ツール -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;700;900&display=swap');
        body { font-family: 'Noto Sans JP', sans-serif; background-color: #f8fafc; }
        .animate-fade-in { animation: fadeIn 0.5s ease-out forwards; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        /* スライダーのカスタムデザイン */
        input[type=range]::-webkit-slider-thumb {
            -webkit-appearance: none; height: 20px; width: 20px;
            border-radius: 50%; background: #2563eb; cursor: pointer; margin-top: -8px;
        }
        input[type=range]::-webkit-slider-runnable-track {
            width: 100%; height: 4px; cursor: pointer; background: #e2e8f0; border-radius: 2px;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // --- アイコン部品 (SVG直書きで崩れを防止) ---
        const Icon = ({ name, size = 24, className = "" }) => {
            const icons = {
                upload: <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="17 8 12 3 7 8"/><line x1="12" x2="12" y1="3" y2="15"/></svg>,
                download: <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" x2="12" y1="15" y2="3"/></svg>,
                shield: <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg>,
                zap: <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/></svg>,
                check: <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="3" strokeLinecap="round" strokeLinejoin="round" className={className}><polyline points="20 6 9 17 4 12"/></svg>,
                smartphone: <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><rect x="5" y="2" width="14" height="20" rx="2" ry="2"/><line x1="12" x2="12.01" y1="18" y2="18"/></svg>,
                smile: <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><circle cx="12" cy="12" r="10"/><path d="M8 14s1.5 2 4 2 4-2 4-2"/><line x1="9" x2="9.01" y1="9" y2="9"/><line x1="15" x2="15.01" y1="9" y2="9"/></svg>,
                user: <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>,
                lock: <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><rect x="3" y="11" width="18" height="11" rx="2" ry="2"/><path d="M7 11V7a5 5 0 0 1 10 0v4"/></svg>,
                filetext: <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/><polyline points="14 2 14 8 20 8"/></svg>,
                refresh: <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"/><path d="M21 3v5h-5"/><path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"/><path d="M3 21v-5h5"/></svg>,
                x: <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>,
                arrowright: <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><line x1="5" y1="12" x2="19" y2="12"/><polyline points="12 5 19 12 12 19"/></svg>
            };
            return icons[name] || null;
        };

        // --- コンポーネント群 ---
        const Button = ({ children, onClick, variant = 'primary', className = '' }) => {
            const baseStyle = "font-bold rounded-2xl transition-all duration-200 active:scale-95 flex items-center justify-center gap-2 px-6 py-3 shadow-sm";
            const variants = {
                primary: "bg-blue-600 hover:bg-blue-700 text-white shadow-blue-100",
                secondary: "bg-white border border-gray-200 hover:border-blue-400 text-gray-700",
                danger: "bg-white border border-gray-200 text-gray-400 hover:text-red-500 hover:bg-red-50"
            };
            return <button onClick={onClick} className={`${baseStyle} ${variants[variant]} ${className}`}>{children}</button>;
        };

        // --- メインアプリ ---
        const App = () => {
            const [page, setPage] = useState('home');
            const [files, setFiles] = useState([]);
            const [quality, setQuality] = useState(0.8);
            const [processing, setProcessing] = useState(false);
            const inputRef = useRef(null);

            useEffect(() => window.scrollTo(0,0), [page]);

            const handleFiles = async (e) => {
                const selected = e.target.files ? Array.from(e.target.files) : [];
                if (selected.length === 0) return;
                setProcessing(true);
                
                // 擬似的な圧縮処理（Canvas使用）
                const processed = await Promise.all(selected.map(async (file) => {
                    return new Promise((resolve) => {
                        const reader = new FileReader();
                        reader.onload = (e) => {
                            const img = new Image();
                            img.onload = () => {
                                const canvas = document.createElement('canvas');
                                canvas.width = img.width;
                                canvas.height = img.height;
                                const ctx = canvas.getContext('2d');
                                ctx.drawImage(img, 0, 0);
                                const url = canvas.toDataURL('image/jpeg', quality);
                                const size = Math.round((url.length - 22) * 3 / 4);
                                resolve({ 
                                    id: Math.random().toString(36), 
                                    name: file.name, 
                                    origSize: file.size, 
                                    newSize: size, 
                                    url 
                                });
                            };
                            img.src = e.target.result;
                        };
                        reader.readAsDataURL(file);
                    });
                }));
                
                setFiles([...processed, ...files]);
                setProcessing(false);
            };

            const formatSize = (bytes) => {
                if (bytes === 0) return '0 B';
                const i = Math.floor(Math.log(bytes) / Math.log(1024));
                return parseFloat((bytes / Math.pow(1024, i)).toFixed(1)) + ' ' + ['B', 'KB', 'MB', 'GB'][i];
            };

            const HomeView = () => (
                <div className="space-y-16 py-8 animate-fade-in">
                    <section className="text-center">
                        <div className="inline-flex items-center gap-2 bg-blue-50 text-blue-600 px-4 py-2 rounded-full text-xs font-bold mb-6">
                            <Icon name="shield" size={16} /> 100%安全・ブラウザ完結型
                        </div>
                        <h1 className="text-4xl md:text-6xl font-black text-gray-900 mb-6 leading-tight">
                            画像を<span className="text-blue-600">ギュッ！</span>と<br/>一瞬で最適化。
                        </h1>
                        <p className="text-gray-500 mb-10">サーバーに送信しないから安心。無料で使えます。</p>
                        
                        <div 
                            className="max-w-2xl mx-auto border-4 border-dashed border-blue-100 rounded-[3rem] p-12 hover:border-blue-300 hover:bg-blue-50/30 transition-all cursor-pointer bg-white"
                            onClick={() => inputRef.current.click()}
                        >
                            <input ref={inputRef} type="file" multiple accept="image/*" className="hidden" onChange={handleFiles} />
                            <div className="w-20 h-20 bg-blue-600 text-white rounded-3xl flex items-center justify-center mx-auto mb-6 shadow-xl shadow-blue-100">
                                {processing ? <Icon name="refresh" className="animate-spin" size={32} /> : <Icon name="upload" size={32} />}
                            </div>
                            <p className="font-bold text-gray-700 text-lg">画像をここにドロップ</p>
                            <p className="text-sm text-gray-400 mt-2">またはクリックして選択</p>
                        </div>
                    </section>

                    {files.length > 0 && (
                        <section className="max-w-3xl mx-auto space-y-6">
                            {files.map(f => (
                                <div key={f.id} className="bg-white p-4 rounded-[2rem] shadow-sm border border-gray-100 flex items-center gap-4 animate-fade-in">
                                    <img src={f.url} className="w-16 h-16 object-cover rounded-2xl bg-gray-50" />
                                    <div className="flex-1 min-w-0">
                                        <p className="font-bold truncate text-sm">{f.name}</p>
                                        <div className="flex items-center gap-2 text-xs mt-1">
                                            <span className="text-gray-400 line-through">{formatSize(f.origSize)}</span>
                                            <Icon name="arrowright" size={12} className="text-gray-300" />
                                            <span className="text-blue-600 font-bold text-sm">{formatSize(f.newSize)}</span>
                                            <span className="bg-blue-100 text-blue-700 px-2 rounded-full font-bold">-{Math.round((1 - f.newSize/f.origSize)*100)}%</span>
                                        </div>
                                    </div>
                                    <Button onClick={() => { const a = document.createElement('a'); a.href = f.url; a.download = f.name; a.click(); }}>保存</Button>
                                </div>
                            ))}
                        </section>
                    )}

                    <section className="grid md:grid-cols-3 gap-6 max-w-5xl mx-auto text-center">
                        <div className="bg-white p-8 rounded-[2rem] border border-gray-100">
                            <Icon name="shield" className="text-blue-600 mx-auto mb-4" size={32} />
                            <h3 className="font-bold mb-2">安全</h3>
                            <p className="text-xs text-gray-500">画像は外に出ません</p>
                        </div>
                        <div className="bg-white p-8 rounded-[2rem] border border-gray-100">
                            <Icon name="zap" className="text-amber-500 mx-auto mb-4" size={32} />
                            <h3 className="font-bold mb-2">爆速</h3>
                            <p className="text-xs text-gray-500">待ち時間ゼロ</p>
                        </div>
                        <div className="bg-white p-8 rounded-[2rem] border border-gray-100">
                            <Icon name="smartphone" className="text-purple-500 mx-auto mb-4" size={32} />
                            <h3 className="font-bold mb-2">スマホOK</h3>
                            <p className="text-xs text-gray-500">アプリ不要です</p>
                        </div>
                    </section>
                </div>
            );

            const PageContent = ({ title, icon, color, children }) => (
                <div className="max-w-3xl mx-auto py-12 animate-fade-in">
                    <div className="bg-white p-10 rounded-[3rem] shadow-lg border border-gray-100">
                        <div className="flex items-center gap-4 mb-8 border-b pb-6">
                            <div className={`p-3 rounded-2xl text-white ${color}`}>{icon}</div>
                            <h2 className="text-2xl font-black">{title}</h2>
                        </div>
                        <div className="text-gray-600 leading-loose space-y-6">{children}</div>
                        <button onClick={() => setPage('home')} className="mt-8 text-blue-600 font-bold flex items-center gap-2 hover:underline">
                            <Icon name="arrowright" size={16} className="rotate-180" /> ホームに戻る
                        </button>
                    </div>
                </div>
            );

            return (
                <div className="min-h-screen flex flex-col">
                    <header className="sticky top-0 z-50 bg-white/80 backdrop-blur border-b border-gray-100 px-6 h-16 flex items-center justify-between">
                        <button onClick={() => setPage('home')} className="flex items-center gap-2 group">
                            <div className="bg-blue-600 text-white p-1.5 rounded-lg group-hover:rotate-6 transition-transform"><Icon name="smile" size={20} /></div>
                            <span className="font-black text-lg">画像圧縮ツールくん</span>
                        </button>
                        <nav className="hidden md:flex gap-6 text-xs font-bold text-gray-400 uppercase tracking-widest">
                            <button onClick={() => setPage('operator')} className="hover:text-blue-600">Operator</button>
                            <button onClick={() => setPage('privacy')} className="hover:text-blue-600">Privacy</button>
                        </nav>
                    </header>

                    <main className="flex-grow px-6">
                        {page === 'home' && <HomeView />}
                        {page === 'operator' && (
                            <PageContent title="運営者情報" color="bg-blue-600" icon={<Icon name="user" />}>
                                <div className="bg-blue-50 p-6 rounded-2xl border-l-4 border-blue-500 text-sm">
                                    <p>昭和？年生まれ。画像圧縮ツールがあったらいいなという思いつきから、VercelとGitHubなどをごちょごちょいじって作りました。見た目はシンプルですが、圧縮率は他に負けない本格性能です。</p>
                                </div>
                                <div className="bg-gray-900 text-white p-6 rounded-2xl">
                                    <p className="text-xs text-gray-400 font-bold uppercase mb-2">Contact</p>
                                    <p className="font-mono text-lg break-all">dongshantian674@gmail.com</p>
                                </div>
                            </PageContent>
                        )}
                        {page === 'privacy' && (
                            <PageContent title="プライバシーポリシー" color="bg-green-500" icon={<Icon name="lock" />}>
                                <p>当ツールはブラウザ完結型です。画像データがサーバーへアップロードされることはありません。</p>
                                <p>アクセス解析のためにCookieを使用することがあります。</p>
                            </PageContent>
                        )}
                        {page === 'terms' && (
                            <PageContent title="利用規約" color="bg-purple-500" icon={<Icon name="filetext" />}>
                                <ul className="list-disc list-inside space-y-2">
                                    <li>本サービスは現状有姿で提供され、動作の保証はいたしません。</li>
                                    <li>利用により生じたいかなる損害についても、運営者は責任を負いません。</li>
                                </ul>
                            </PageContent>
                        )}
                    </main>

                    <footer className="py-10 text-center border-t mt-10">
                        <div className="flex justify-center gap-6 mb-4 text-xs font-bold text-gray-400 uppercase tracking-widest">
                            <button onClick={() => setPage('home')}>Home</button>
                            <button onClick={() => setPage('operator')}>Operator</button>
                            <button onClick={() => setPage('terms')}>Terms</button>
                            <button onClick={() => setPage('privacy')}>Privacy</button>
                        </div>
                        <p className="text-[10px] text-gray-300 font-black tracking-widest">&copy; 2026 UMEGAOKA-CONNECT.SITE</p>
                    </footer>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
